<% if params[:status] == 'active' %>
  <h2>アクティブユーザー一覧</h2>
<% elsif params[:status] == 'deactivated' %>
  <h2>退会ユーザー一覧</h2>
  <p>※ 通常の退会ユーザーです。除名ユーザーは含みません。</p>
<% elsif params[:status] == 'banned'  %>
  <h2>除名ユーザー一覧</h2>
<% else %>
  <h2>全エンドユーザー一覧</h2>
<% end %>

<div>
  <button><%= link_to 'アクティブ', admin_users_path(status: 'active') %></button>
  <button><%= link_to '退会（非除名）', admin_users_path(status: 'deactivated') %></button>
  <button><%= link_to '除名', admin_users_path(status: 'banned') %></button>
  <button><%= link_to '全て', admin_users_path %></button>
</div>

<table>
  <thead>
    <th>ユーザー</th>
    <th>都道府県</th>
    <th>誕生年</th>
    <th>自己紹介</th>
    <th>ステータス</th>
    <th>投稿</th>
    <th>コメント</th>
    <th>登録日</th>
    <th>プロフィール更新日</th>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td>
          <%= link_to admin_user_path(user) do %>
            <%= image_tag user.get_profile_image(50, 50) %>
            <%= user.name %>
          <% end %>
        </td>
        <td>
          <%= user.prefecture %>
        </td>
        <td>
          <%= user.birth_year %>
        </td>
        <td>
          <%= user.introduction %>
        </td>
        <td>
          <% if user.is_forbidden == true %>
            除名済み
          <% elsif user.is_active == false %>
            退会済
          <% else %>
            有効
          <% end %>
        </td>
        <td>
          <%= link_to admin_user_posts_path(user.id) do %>
            <i class="fa-solid fa-pen-to-square"></i> <%= user.posts.count %>
          <% end %>
        </td>
        <td>
          <%= link_to admin_user_comments_path(user.id) do %>
            <i class="fa-regular fa-comment"></i> <%= user.post_comments.count %>
          <% end %>
        </td>
        <td><%= user.created_at.strftime('%Y/%m/%d') %></td>
        <td><%= user.updated_at.strftime('%Y/%m/%d') %></td>
      </tr>
    <% end %>
  </tbody>
</table>